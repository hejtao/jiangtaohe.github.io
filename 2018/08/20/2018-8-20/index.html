<!DOCTYPE html>
<html lang="z">
<head>
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    
    <title>Golang编程基础 | 米琴香光</title>
    <meta name="renderer" content="webkit">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <meta name="description" content="RSS">

    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Golang编程基础 | 米琴香光">
    <meta name="twitter:description" content="RSS">

    <meta property="og:type" content="article">
    <meta property="og:title" content="Golang编程基础 | 米琴香光">
    <meta property="og:description" content="RSS">

    
    <meta name="author" content="Jiang-Tao He">
    
    <link rel="stylesheet" href="/css/vno.css">
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css">

    
    <link rel="icon" href="/images/icon.jpg">
    

    <meta name="generator" content="hexo"/>
    
    <link rel="alternate" type="application/rss+xml" title="米琴香光" href="/atom.xml">
    

    <link rel="canonical" href="https://hejtao.netlify.com/2018/08/20/2018-8-20/"/>

              
<link rel="stylesheet" href="/css/prism.css" type="text/css"><!-- hexo-inject:begin --><!-- hexo-inject:end --></head>

<body class="home-template no-js">
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><script src="//cdn.bootcss.com/jquery/2.1.4/jquery.min.js"></script>
    <script src="/js/main.js"></script>
    <span class="mobile btn-mobile-menu">
        <i class="fa fa-list btn-mobile-menu__icon"></i>
        <i class="fa fa-angle-up btn-mobile-close__icon hidden"></i>
    </span>
    <header class="panel-cover panel-cover--collapsed" style="background-image: url(/images/background-cover.jpg)">
  <div class="panel-main">
    <div class="panel-main__inner panel-inverted">
    <div class="panel-main__content">

        <a href="/"><img src="/images/avatar.jpg" width="80" alt="米琴香光 logo" class="panel-cover__logo logo" /></a>
        <h1 class="panel-cover__title panel-title"><a href="/" title="返回封面">米琴香光</a></h1>
        
        <hr class="panel-cover__divider" />
        <p class="panel-cover__description"></p>
        <hr class="panel-cover__divider panel-cover__divider--secondary" />

        <div class="navigation-wrapper">
          <div>
          <nav class="cover-navigation cover-navigation--primary">
            <ul class="navigation">
              <li class="navigation__item"><a href="/#blog" class="blog-button">笔记</a></li>
            
              <li class="navigation__item"><a href="/archives">归档</a></li>
            
              <li class="navigation__item"><a href="/videos">视频</a></li>
            
            </ul>
          </nav>
          </div>
          <div>
          <nav class="cover-navigation navigation--social">
  <ul class="navigation">

  <!-- Weibo-->
  
  <li class="navigation__item">
    <a href="https://weibo.com/hjt1993" title="我的微博" target="_blank">
      <i class='social fa fa-weibo'></i>
      <span class="label">Weibo</span>
    </a>
  </li>


  <!-- Github -->
  
  <li class="navigation__item">
    <a href="https://github.com/hejtao" title="查看我的GitHub主页" target="_blank">
      <i class='social fa fa-github'></i>
      <span class="label">Github</span>
    </a>
  </li>


<!-- Stack Overflow -->
        

  <!-- Google Plus -->
  

<!-- Facebook -->

  <li class="navigation__item">
    <a href="https://facebook.com/chiangtaoho" title="上Facebook找我" target="_blank">
      <i class='social fa fa-facebook'></i>
      <span class="label">Facebook</span>
    </a>
  </li>


<!-- Twitter -->



  <li class="navigation__item">
    <a href="/atom.xml" title="RSS" target="_blank">
      <i class='social fa fa-rss'></i>
      <span class="label">RSS</span>
    </a>
  </li>



  <li class="navigation__item">
    <a href="mailto:hejtao@outlook.com" title="邮件联系我" target="_blank">
      <i class='social fa fa-envelope'></i>
      <span class="label">Email</span>
    </a>
  </li>


  </ul>
</nav>

          </div>
          <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=250 height=86 src="//music.163.com/outchain/player?type=2&id=27538415&auto=0&height=66"></iframe>
        </div>
    </div>
    </div>
    <div class="panel-cover--overlay cover-blue"></div>
  </div>
</header>


    <div class="content-wrapper">
        <div class="content-wrapper__inner">
            <article class="post-container post-container--single">

  <header class="post-header">
    <div class="post-meta">
      <time datetime="2018-08-20T05:59:10.000Z" class="post-list__meta--date date">2018-08-20</time> &#8226; <span class="post-meta__tags tags"> 
  <a class="tag-link" href="/tags/Golang/">Golang</a>, <a class="tag-link" href="/tags/长文/">长文</a>
 </span>
    

    </div>
    <h1 class="post-title">Golang编程基础</h1>
  </header>

  <section class="post">
    <meta name="referrer" content="no-referrer">
<div class="toc">
<!-- toc -->
<ul>
<li><a href="#zai-ubuntu-an-zhuang">在Ubuntu安装:</a></li>
<li><a href="#shu-ju-lei-xing">数据类型:</a>
<ul>
<li><a href="#ji-ben-lei-xing">基本类型：</a></li>
<li><a href="#ju-ji-lei-xing-aggregate-types">聚集类型 (aggregate types)：</a>
<ul>
<li><a href="#shu-zu">数组</a></li>
<li><a href="#jie-gou">结构</a></li>
</ul>
</li>
<li><a href="#yin-yong-lei-xing">引用类型</a>
<ul>
<li><a href="#zhi-zhen">指针</a></li>
<li><a href="#qie-pian-slice">切片（slice）</a></li>
<li><a href="#zi-dian-map">字典（map）</a></li>
<li><a href="#han-shu">函数</a></li>
<li><a href="#tong-dao-channel">通道（channel）</a></li>
</ul>
</li>
<li><a href="#jie-kou-lei-xing-interface">接口类型（interface）：</a></li>
</ul>
</li>
<li><a href="#kong-zhi-liu-for-if-switch-defer-goto">控制流 （for if switch defer goto）：</a></li>
<li><a href="#chuang-jian-gong-cheng-mu-lu">创建工程目录：</a></li>
<li><a href="#tips">Tips:</a></li>
<li><a href="#qi-ta">其他：</a></li>
<li><a href="#can-kao-zi-liao">参考资料：</a></li>
</ul>
<!-- tocstop -->
</div>
<h3><span id="zai-ubuntu-an-zhuang">在Ubuntu安装:</span><a href="#zai-ubuntu-an-zhuang" class="header-anchor">#</a></h3>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&gt;<span class="built_in">cd</span> ~ </span><br><span class="line">&gt;wget https://dl.google.com/go/go1.11.2.linux-amd64.tar.gz</span><br><span class="line">&gt;tar -C /usr/<span class="built_in">local</span> -xzf go1.11.2.linux-amd64.tar.gz    // 解压到得到的 go 目录，放到 /usr/<span class="built_in">local</span> 目录下</span><br><span class="line">&gt;vim .bashrc    // 写入以下内容</span><br><span class="line"><span class="built_in">export</span> GOPATH=~/hejtao/go_projects</span><br><span class="line"><span class="built_in">export</span> GOROOT=/usr/<span class="built_in">local</span>/go</span><br><span class="line"><span class="built_in">export</span> GOBIN=<span class="variable">$GOROOT</span>/bin</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$GOBIN</span></span><br><span class="line">&gt;<span class="built_in">source</span> .bashrc</span><br></pre></td></tr></table></figure>
<h3><span id="shu-ju-lei-xing">数据类型:</span><a href="#shu-ju-lei-xing" class="header-anchor">#</a></h3>
<p><img src="https://upload-images.jianshu.io/upload_images/1863961-07626fa602c42064.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/600" alt=""></p>
<h4><span id="ji-ben-lei-xing">基本类型：</span><a href="#ji-ben-lei-xing" class="header-anchor">#</a></h4>
<ul>
<li>数值
<ul>
<li>整型：<code>int</code>； <code>int8</code>； <code>int16</code>；  <code>int32</code>(<code>rune</code>，<code>Unicode</code>)；  <code>int64</code>； <code>uint</code>； <code>uint8</code>(<code>byte</code>)； <code>uint16</code>； <code>uint32</code>； <code>uint64</code>； <code>uintptr</code>
<code>int</code>, <code>uint</code>, <code>uintptr</code> 在 32 位系统上是 32 位，在 64位 系统上是 64位</li>
<li>浮点型：<code>float32</code>； <code>float64</code></li>
<li>复数型：<code>complex64</code>； <code>complex128</code></li>
</ul>
</li>
<li>字符串：使用双引号 <code>&quot;a&quot;</code></li>
<li>布尔: <code>true</code>； <code>false</code></li>
<li>常量：三种基本类型</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span>(</span><br><span class="line">  kb = <span class="number">1024</span></span><br><span class="line">  e = <span class="number">2.71828182845904523536028747135266249775724709369995957496696763</span></span><br><span class="line">  F = <span class="literal">false</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>在 <code>if</code>语句中，若检验条件为<code>i &gt;= 0</code>，则<code>i</code> 的类型不宜为 <code>uint</code> 型（<code>uint</code> 数据始终 &gt;= 0）。尽管内置函数 <code>len()</code> 返回值是非负整数，但它际返回 <code>int</code> 型，</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">medals := []<span class="keyword">string</span>&#123;<span class="string">"gold"</span>, <span class="string">"silver"</span>, <span class="string">"bronze"</span>&#125;</span><br><span class="line"><span class="keyword">for</span> i := <span class="built_in">len</span>(medals)<span class="number">-1</span>; i &gt;= <span class="number">0</span>; i--&#123;</span><br><span class="line">  fmt.Println(medals[i]) <span class="comment">// "bronze", "silver", "gold"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>基本类型与操作符构成表达式</p>
<p><img src="https://upload-images.jianshu.io/upload_images/1863961-f1c19a4e5f60b7af.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/300" alt=""></p>
<ul>
<li>取余 <code>%</code> 只用于整型；余数与被除数符号相同，<code>5%3=2</code>； <code>-5%3=-2</code></li>
<li><code>5.0/4=1.25</code>；<code>5/4.0=1.25</code>；<code>5/4=1</code></li>
<li><code>&amp;&amp;</code> 若左边的表达式结果为 <code>false</code>，不检验右边的表达式；<code>&amp;</code> 始终检验两边的表达式</li>
<li>与或<code>^</code> ; 一元前缀<code>^</code></li>
</ul>
<h4><span id="ju-ji-lei-xing-aggregate-types">聚集类型 (aggregate types)：</span><a href="#ju-ji-lei-xing-aggregate-types" class="header-anchor">#</a></h4>
<h5><span id="shu-zu">数组</span><a href="#shu-zu" class="header-anchor">#</a></h5>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a [<span class="number">3</span>]<span class="keyword">int</span></span><br><span class="line">r := [...]<span class="keyword">int</span>&#123;<span class="number">99</span>: <span class="number">1</span>&#125;    <span class="comment">// 索引为99的元素，r[99]， 等于 1，其他默认 0</span></span><br><span class="line"></span><br><span class="line">p := <span class="built_in">new</span>([<span class="number">10</span>]<span class="keyword">int</span>)    <span class="comment">// 将生成的数组的指针赋给 p, 为 *[10]int 类型</span></span><br><span class="line">p[<span class="number">0</span>]=<span class="number">1</span>    <span class="comment">// 给 p 指向的数组的索引为0的元素赋值 1</span></span><br></pre></td></tr></table></figure>
<p>数组的长度也是数组类型的一部分，因此 <code>[3]int</code> 和 <code>[4]int</code> 是不同类型的数组，不能进行比较或赋值。</p>
<h5><span id="jie-gou">结构</span><a href="#jie-gou" class="header-anchor">#</a></h5>
<p>（1）结构的字段（field）</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> person <span class="keyword">struct</span>&#123;      <span class="comment">// 定义 person 类型</span></span><br><span class="line">    gender <span class="keyword">string</span></span><br><span class="line">    age <span class="keyword">int</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    student := person&#123;&#125;</span><br><span class="line">    student.age = <span class="number">16</span></span><br><span class="line">    student.gender = <span class="string">"male"</span></span><br><span class="line">    <span class="comment">// or</span></span><br><span class="line">    student := person&#123;</span><br><span class="line">       gender : <span class="string">"male"</span>, </span><br><span class="line">        age : <span class="number">16</span>,    <span class="comment">//逗号不能省</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// or</span></span><br><span class="line">    student := person&#123;<span class="string">"male"</span>, <span class="number">16</span>&#125;</span><br><span class="line"></span><br><span class="line">    teacher := &amp;person&#123;    <span class="comment">//取指针</span></span><br><span class="line">      gender : <span class="string">"female"</span>, </span><br><span class="line">       age : <span class="number">30</span>,    </span><br><span class="line">    &#125;</span><br><span class="line">    teacher.age = <span class="number">36</span>    <span class="comment">//指针 teacher 仍然可以进行点操作</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>指针也可以进行点操作。</p>
</blockquote>
<p>匿名结构，字段匿名</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">student := <span class="keyword">struct</span>&#123;      <span class="comment">// 匿名结构</span></span><br><span class="line">    gender : <span class="keyword">string</span></span><br><span class="line">    age : <span class="keyword">int</span></span><br><span class="line">&#125;&#123;</span><br><span class="line">    gender : <span class="string">"male"</span>,</span><br><span class="line">    age : <span class="string">"17"</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> person <span class="keyword">struct</span>&#123;      </span><br><span class="line">    <span class="keyword">string</span></span><br><span class="line">    <span class="keyword">int</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 按照顺序初始化</span></span><br><span class="line">student := person&#123;<span class="string">"male"</span>, <span class="number">10</span>&#125;</span><br></pre></td></tr></table></figure>
<p>结构嵌套，</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> person <span class="keyword">struct</span>&#123;      </span><br><span class="line">    gender <span class="keyword">string</span></span><br><span class="line">    age <span class="keyword">int</span></span><br><span class="line">    parents <span class="keyword">struct</span>&#123;      <span class="comment">//  嵌套一个匿名结构</span></span><br><span class="line">        dad, mom : <span class="keyword">string</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> address <span class="keyword">struct</span>&#123;</span><br><span class="line">    state, city <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> person2 <span class="keyword">struct</span>&#123;      </span><br><span class="line">    gender <span class="keyword">string</span></span><br><span class="line">    age <span class="keyword">int</span></span><br><span class="line">    address    <span class="comment">// 嵌套你一个结构address</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    student := person&#123;gender : <span class="string">"female"</span>, age : <span class="number">10</span>&#125;</span><br><span class="line">    student.parents.dad = <span class="string">"Tom"</span></span><br><span class="line">    student.parents.mom = <span class="string">"Lily"</span>     </span><br><span class="line">    </span><br><span class="line">    student2 := person2&#123;gender:<span class="string">"female"</span>, age:<span class="number">10</span>, address : address&#123;county:<span class="string">"LA"</span> state:<span class="string">"California"</span>&#125;  &#125; </span><br><span class="line">    student2.address.state = <span class="string">"Massachusetts"</span>    <span class="comment">// or</span></span><br><span class="line">    student2.state = <span class="string">"Massachusetts"</span>  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>（2）结构的方法（method）
函数与方法</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"math"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Point <span class="keyword">struct</span>&#123; X, Y <span class="keyword">float64</span> &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Distance</span>(<span class="params">p, q Point</span>) <span class="title">float64</span></span> &#123;		<span class="comment">//函数</span></span><br><span class="line">	<span class="keyword">return</span> math.Hypot(q.X-p.X, q.Y-p.Y)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> (<span class="params">p Point</span>) <span class="title">Distance</span>(<span class="params">q Point</span>) <span class="title">float64</span></span> &#123;		<span class="comment">// 方法，在函数名前增加一个形参（receiver） 类似于Java的this 和python的 self，</span></span><br><span class="line">	<span class="keyword">return</span> math.Hypot(q.X-p.X, q.Y-p.Y)             <span class="comment">// 接收者的名称通常取它的类型名称的第一个字母</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">	p := Point&#123;<span class="number">1</span>, <span class="number">2</span>&#125;</span><br><span class="line">	q := Point&#123;<span class="number">4</span>, <span class="number">6</span>&#125;</span><br><span class="line">	fmt.Println(Distance(p, q))		<span class="comment">// 打印 5， 调用函数</span></span><br><span class="line">	fmt.Println(p.Distance(q))		<span class="comment">// 调用方法</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>当需要使用方法对值（value of type T，相对于方法来讲就是实参，argument） 的字段进行修改时，使用接收者为指针的方法或者叫指针方法</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> (<span class="params">p *Point</span>) <span class="title">ScaleBy</span>(<span class="params">factor <span class="keyword">float64</span></span>)</span> &#123;      <span class="comment">// 接收者参数p的类型是指针类型</span></span><br><span class="line">    p.X *= factor      <span class="comment">// p在这里是指针，等价于 (*p).X</span></span><br><span class="line">    p.Y *= factor</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>同一个 struct 的方法和字段占据相同的命名空间（name space），因此两者的名称不能重复；
指针方法看作高权限方法。</p>
</blockquote>
<p>对方法的调用, 值（实参） 和 接收者（形参）类型要相同</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Point&#123;<span class="number">1</span>, <span class="number">2</span>&#125;.Distance(q)     <span class="comment">// Point  Point</span></span><br><span class="line">pptr.ScaleBy(<span class="number">2</span>)       <span class="comment">// *Point  *Point</span></span><br><span class="line"></span><br><span class="line">pptr.Distance(q)     <span class="comment">// 隐含 (*pptr)</span></span><br><span class="line">p.ScaleBy(<span class="number">2</span>)     <span class="comment">// 隐含 (&amp;p)</span></span><br><span class="line"></span><br><span class="line">             Point&#123;<span class="number">1</span>, <span class="number">2</span>&#125;.ScaleBy(<span class="number">2</span>)    <span class="comment">//错误！！！</span></span><br><span class="line">(&amp;Point&#123;<span class="number">1</span>, <span class="number">2</span>&#125;).ScaleBy(<span class="number">2</span>)</span><br></pre></td></tr></table></figure>
<p>不仅仅是 <code>struct</code></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> INT <span class="keyword">int</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">	<span class="keyword">var</span> a INT</span><br><span class="line">	a = <span class="number">1</span></span><br><span class="line">	a.Print()    <span class="comment">// 打印 2</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> (<span class="params">a *INT</span>) <span class="title">Print</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">	*a = <span class="number">2</span></span><br><span class="line">	fmt.Println(*a)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>方法是与命名类型(named type)相关联的函数。</p>
</blockquote>
<h4><span id="yin-yong-lei-xing">引用类型</span><a href="#yin-yong-lei-xing" class="header-anchor">#</a></h4>
<h5><span id="zhi-zhen">指针</span><a href="#zhi-zhen" class="header-anchor">#</a></h5>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> p *<span class="keyword">int</span></span><br><span class="line">i := <span class="number">20</span></span><br><span class="line">p = &amp;i</span><br><span class="line">*p = <span class="number">10</span>    <span class="comment">// i 的值为 10</span></span><br></pre></td></tr></table></figure>
<h5><span id="qie-pian-slice">切片（slice）</span><a href="#qie-pian-slice" class="header-anchor">#</a></h5>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> s []<span class="keyword">int</span>    <span class="comment">// 声明切片 s</span></span><br><span class="line">a := [<span class="number">5</span>]<span class="keyword">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;</span><br><span class="line">s = a[:<span class="number">2</span>]    <span class="comment">// [1, 2]， len(s)等于2，cap(s)等于5</span></span><br><span class="line">s = a[<span class="number">0</span>:<span class="number">1</span>]    <span class="comment">// [1]，len(s)等于1，cap(s)等于5</span></span><br><span class="line">s = a[<span class="number">3</span>:]    <span class="comment">// [4, 5]，len(s)等于2，cap(s)等于2</span></span><br><span class="line"></span><br><span class="line">s := <span class="built_in">make</span>([]<span class="keyword">int</span>, <span class="number">2</span>, <span class="number">4</span>)    <span class="comment">//make([]type, len, cap) ，切片长度为2，底层数组的长度为4</span></span><br><span class="line">s = <span class="built_in">append</span>(s, <span class="number">1</span>)    <span class="comment">// s 的地址不变</span></span><br><span class="line">s = <span class="built_in">append</span>(s, <span class="number">2</span>, <span class="number">3</span>)    <span class="comment">// 生成新的数组，地址改变，容量翻倍，也就是cap(s)等于4*2=8</span></span><br><span class="line">s1 := []<span class="keyword">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;</span><br><span class="line">s2 := []<span class="keyword">int</span>&#123;<span class="number">4</span>, <span class="number">5</span>&#125;</span><br><span class="line"><span class="built_in">copy</span>(s1, s2)    <span class="comment">//把 s2 复制到 s1，s1 为 [4, 5, 3]</span></span><br><span class="line"></span><br><span class="line">s1 = []<span class="keyword">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;</span><br><span class="line"><span class="built_in">copy</span>(s2, s1)    <span class="comment">// s2 为 [1, 2]</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>切片的本质是对底层数组的引用；切片的容量（cap）是切片的始索引到底层数组的末索引的长度。</p>
</blockquote>
<h5><span id="zi-dian-map">字典（map）</span><a href="#zi-dian-map" class="header-anchor">#</a></h5>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> m <span class="keyword">map</span>[<span class="keyword">int</span>]<span class="keyword">string</span>    <span class="comment">// key int 型；value string 型</span></span><br><span class="line">m = <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">int</span>]<span class="keyword">string</span>)</span><br><span class="line">m2 := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">int</span>]<span class="keyword">string</span>)</span><br><span class="line"></span><br><span class="line">m[<span class="number">0</span>] = <span class="string">"OK"</span></span><br><span class="line"><span class="built_in">delete</span>(m, <span class="number">0</span>)    <span class="comment">// 删除 m 中键为0的键值对</span></span><br></pre></td></tr></table></figure>
<p>嵌套，</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">m := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">int</span>]<span class="keyword">map</span>[<span class="keyword">int</span>]<span class="keyword">string</span>)    <span class="comment">// value  map型</span></span><br><span class="line">m[<span class="number">1</span>] = <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">int</span>]<span class="keyword">string</span>)</span><br><span class="line">m[<span class="number">1</span>][<span class="number">2</span>] = <span class="string">"YES"</span></span><br></pre></td></tr></table></figure>
<h5><span id="han-shu">函数</span><a href="#han-shu" class="header-anchor">#</a></h5>
<p><code>func main(int, []string) int</code>
means， function main takes an int and a slice of strings and returns an int
函数作为类型，</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> f <span class="function"><span class="keyword">func</span>(<span class="params"><span class="keyword">func</span>(<span class="keyword">int</span>,<span class="keyword">int</span></span>) <span class="title">int</span>, <span class="title">int</span>) <span class="title">func</span>(<span class="params"><span class="keyword">int</span>, <span class="keyword">int</span></span>) <span class="title">int</span></span></span><br></pre></td></tr></table></figure>
<p>不定长变参，闭包</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  var_args(<span class="number">1</span>)    </span><br><span class="line">  var_args(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)    </span><br><span class="line"></span><br><span class="line">  f := closure(<span class="number">10</span>)</span><br><span class="line">  fmt.Println(f(<span class="number">1</span>))   </span><br><span class="line">  fmt.Println(f(<span class="number">2</span>))    </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">var_args</span>(<span class="params">args ...<span class="keyword">int</span></span>)</span>&#123;</span><br><span class="line">  fmt.Println(args)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">closure</span>(<span class="params">x <span class="keyword">int</span></span>) <span class="title">func</span>(<span class="params"><span class="keyword">int</span></span>) <span class="title">int</span></span>&#123;    <span class="comment">// 返回匿名函数</span></span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">func</span>(<span class="params">y <span class="keyword">int</span></span>) <span class="title">int</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x + y</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">输出：</span><br><span class="line">[<span class="number">1</span>]</span><br><span class="line">[<span class="number">1</span> <span class="number">2</span> <span class="number">3</span>]</span><br><span class="line"><span class="number">11</span></span><br><span class="line"><span class="number">12</span></span><br></pre></td></tr></table></figure>
<h5><span id="tong-dao-channel">通道（channel）</span><a href="#tong-dao-channel" class="header-anchor">#</a></h5>
<p>channel 是 goroutine 沟通的桥梁，通过 make 创建，close 关闭</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">	c := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">bool</span>)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">go</span> <span class="function"><span class="keyword">func</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"I from goroutine !"</span>)</span><br><span class="line">		c &lt;- <span class="literal">true</span></span><br><span class="line">	&#125;()</span><br><span class="line"></span><br><span class="line">	&lt;-c</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>channel 作为函数形参</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">	c := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">bool</span>)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">go</span> Hello(c)</span><br><span class="line"></span><br><span class="line">	&lt;-c</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Hello</span>(<span class="params">c <span class="keyword">chan</span> <span class="keyword">bool</span></span>)</span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"Hello, I from goroutine!"</span>)</span><br><span class="line">	c &lt;- <span class="literal">true</span>    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>多个 goroutine，多个channel</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"runtime"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">	runtime.GOMAXPROCS(runtime.NumCPU())    <span class="comment">// 开启多核</span></span><br><span class="line">	c := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">bool</span>)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">5</span>; i++ &#123;    <span class="comment">// 启动多个 goroutin</span></span><br><span class="line">		<span class="keyword">go</span> Decomposition(c, i, <span class="number">100000007</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">5</span>; i++ &#123;    <span class="comment">// 多个 channel 阻塞</span></span><br><span class="line">		&lt;-c</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Decomposition</span>(<span class="params">c <span class="keyword">chan</span> <span class="keyword">bool</span>, index <span class="keyword">int</span>, n <span class="keyword">int</span></span>)</span> &#123;    <span class="comment">// 质数分解</span></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">2</span>; i &lt;= n; i++ &#123;</span><br><span class="line">		<span class="keyword">for</span> n != i &#123;</span><br><span class="line">			<span class="keyword">if</span> n%i == <span class="number">0</span> &#123;</span><br><span class="line">				fmt.Printf(<span class="string">"%d*"</span>, i)</span><br><span class="line">				n = n / i</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				<span class="keyword">break</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Printf(<span class="string">"%d: %d\n"</span>, index, n)</span><br><span class="line"></span><br><span class="line">	c &lt;- <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">输出：   </span><br><span class="line"><span class="number">0</span>: <span class="number">100000007</span></span><br><span class="line"><span class="number">2</span>: <span class="number">100000007</span></span><br><span class="line"><span class="number">1</span>: <span class="number">100000007</span></span><br><span class="line"><span class="number">4</span>: <span class="number">100000007</span></span><br><span class="line"><span class="number">3</span>: <span class="number">100000007</span></span><br><span class="line">从输出结果的顺序可以看出 goroutine 并非先启动先执行</span><br></pre></td></tr></table></figure>
<p>使用同步包来代替 channel</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"runtime"</span></span><br><span class="line">	<span class="string">"sync"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">	runtime.GOMAXPROCS(runtime.NumCPU())</span><br><span class="line">	wg := sync.WaitGroup&#123;&#125;</span><br><span class="line">	wg.Add(<span class="number">5</span>)    <span class="comment">//  添加 5 个 任务（goroutine）</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">5</span>; i++ &#123;</span><br><span class="line">		<span class="keyword">go</span> Decomposition(&amp;wg, i, <span class="number">100000007</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	wg.Wait()    <span class="comment">// 等到任务数减到 0 </span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Decomposition</span>(<span class="params">wg *sync.WaitGroup, m <span class="keyword">int</span>, n <span class="keyword">int</span></span>)</span> &#123;</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">2</span>; i &lt;= n; i++ &#123;</span><br><span class="line">		<span class="keyword">for</span> n != i &#123;</span><br><span class="line">			<span class="keyword">if</span> n%i == <span class="number">0</span> &#123;</span><br><span class="line">				fmt.Printf(<span class="string">"%d*"</span>, i)</span><br><span class="line">				n = n / i</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				<span class="keyword">break</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Printf(<span class="string">"%d: %d\n"</span>, m, n)</span><br><span class="line"></span><br><span class="line">	wg.Done()    <span class="comment">// 任务数减 1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">输出：</span><br><span class="line"><span class="number">0</span>: <span class="number">100000007</span></span><br><span class="line"><span class="number">2</span>: <span class="number">100000007</span></span><br><span class="line"><span class="number">4</span>: <span class="number">100000007</span></span><br><span class="line"><span class="number">1</span>: <span class="number">100000007</span></span><br><span class="line"><span class="number">3</span>: <span class="number">100000007</span></span><br></pre></td></tr></table></figure>
<p><code>selec{}</code>语句，
如果有多个case 读取数据，select会随机选择一个case执行，其他不执行；
如果没有case读取数据，就执行default；
如果没有case读取数据，且没有default，select将阻塞，直到某个case可以执行。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">	c1, c2, block := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">int</span>), <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">string</span>), <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">bool</span>)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">go</span> <span class="function"><span class="keyword">func</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">		<span class="keyword">for</span> &#123;</span><br><span class="line">			<span class="keyword">select</span> &#123;    <span class="comment">// 按随机顺序处理多个 case</span></span><br><span class="line">			<span class="keyword">case</span> message, open := &lt;-c1:</span><br><span class="line">				<span class="keyword">if</span> !open &#123;    <span class="comment">// 如果通道 c1 关闭，则跳出无限循环</span></span><br><span class="line">					block &lt;- <span class="literal">true</span></span><br><span class="line">					<span class="keyword">break</span></span><br><span class="line">				&#125;</span><br><span class="line">				fmt.Println(<span class="string">"A message from main by c1:"</span>, message)</span><br><span class="line"></span><br><span class="line">			<span class="keyword">case</span> message, open := &lt;-c2:</span><br><span class="line">				<span class="keyword">if</span> !open &#123;    <span class="comment">// 如果通道 c2 关闭，则跳出无限循环</span></span><br><span class="line">					block &lt;- <span class="literal">true</span></span><br><span class="line">					<span class="keyword">break</span></span><br><span class="line">				&#125;</span><br><span class="line">				fmt.Println(<span class="string">"A message from main by c2:"</span>, message)</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;()</span><br><span class="line"></span><br><span class="line">	c1 &lt;- <span class="number">10</span></span><br><span class="line">	c2 &lt;- <span class="string">"hello"</span></span><br><span class="line">	c1 &lt;- <span class="number">20</span></span><br><span class="line">	c2 &lt;- <span class="string">"world"</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">close</span>(c1)    <span class="comment">// 关闭通道 c1</span></span><br><span class="line"></span><br><span class="line">	&lt;-block</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">输出：</span><br><span class="line">A message from main by c1: <span class="number">10</span></span><br><span class="line">A message from main by c2: hello</span><br><span class="line">A message from main by c1: <span class="number">20</span></span><br><span class="line">A message from main by c2: world</span><br></pre></td></tr></table></figure>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"time"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">	<span class="keyword">select</span> &#123;</span><br><span class="line">	<span class="keyword">case</span> &lt;-time.After(<span class="number">2000000</span> * time.Microsecond):</span><br><span class="line">		fmt.Println(<span class="string">"2 seconds"</span>)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">case</span> &lt;-time.After(<span class="number">1999999</span> * time.Microsecond):</span><br><span class="line">		fmt.Println(<span class="string">"1.999999 seconds"</span>)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">输出：</span><br><span class="line"><span class="number">1.999999</span> seconds</span><br></pre></td></tr></table></figure>
<h4><span id="jie-kou-lei-xing-interface">接口类型（interface）：</span><a href="#jie-kou-lei-xing-interface" class="header-anchor">#</a></h4>
<p>（1）接口代表某些方法的集合</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> game <span class="keyword">interface</span> &#123;</span><br><span class="line">	Strike_of_Kings() <span class="keyword">int</span></span><br><span class="line">	Battle_Grounds() <span class="keyword">int</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">type</span> contact <span class="keyword">interface</span> &#123;</span><br><span class="line">	Wechat()</span><br><span class="line">	QQ()</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">type</span> smartphone <span class="keyword">interface</span>&#123;    <span class="comment">// 接口嵌套，</span></span><br><span class="line">    game</span><br><span class="line">    contact</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> iphone <span class="keyword">struct</span> &#123;    </span><br><span class="line">	version <span class="keyword">string</span></span><br><span class="line">	price   <span class="keyword">float32</span></span><br><span class="line">	user    <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> (<span class="params">iph iphone</span>) <span class="title">Wechat</span>(<span class="params"></span>)</span> &#123;    </span><br><span class="line">	fmt.Println(<span class="string">"I installed wechat on my iphone"</span>, iph.version)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> (<span class="params">iph *iphone</span>) <span class="title">QQ</span>(<span class="params"></span>)</span> &#123;    </span><br><span class="line">	fmt.Println(<span class="string">"I installed wechat on my iphone"</span>, iph.version)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// iphone 不满足 contact 接口</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> (<span class="params">iph iphone</span>) <span class="title">Battle_Grounds</span>(<span class="params"></span>) <span class="title">int</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"There are 4 teammates at most in the Battle Grounds."</span>)</span><br><span class="line">	<span class="keyword">return</span> <span class="number">4</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> (<span class="params">iph iphone</span>) <span class="title">Strike_of_Kings</span>(<span class="params"></span>) <span class="title">int</span></span> &#123;    </span><br><span class="line">	fmt.Println(<span class="string">"There are 5 teammates at most in the Strike of Kings."</span>)</span><br><span class="line">	<span class="keyword">return</span> <span class="number">5</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// iphone 满足 game 接口</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> (<span class="params">iph *iphone</span>) <span class="title">New_Version</span>(<span class="params">version <span class="keyword">string</span></span>)</span> &#123;</span><br><span class="line">	iph.version = version</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">all_round_game</span>(<span class="params">game</span>)</span> &#123;      <span class="comment">// 接口作为形参</span></span><br><span class="line">	fmt.Println(<span class="string">"Both Strike of_Kings and Battle Grounds have installed."</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line"></span><br><span class="line">	my_phone := iphone&#123;<span class="string">"X"</span>, <span class="number">8316</span>, <span class="string">"Xiaohe"</span>&#125;</span><br><span class="line">	my_phone.Wechat()</span><br><span class="line">    fmt.Println(my_phone.Battle_Grounds())</span><br><span class="line"></span><br><span class="line">	all_round_game(my_phone)    <span class="comment">// my_phone 符合 game 接口，可作为该函数的实参</span></span><br><span class="line">	<span class="keyword">var</span> _ game = iphone   <span class="comment">// 确保 iphone 实现了接口game </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>（2）任何类型都满足空接口；空接口<code>interface{}</code>作为形参可以接受任何类型的实参</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">	m := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">int</span>]<span class="keyword">interface</span>&#123;&#125;)</span><br><span class="line">	m[<span class="number">1</span>] = <span class="string">"a"</span></span><br><span class="line">	m[<span class="number">2</span>] = <span class="number">2</span></span><br><span class="line">	m[<span class="number">3</span>] = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">	print_map(m)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">print_map</span>(<span class="params">m <span class="keyword">map</span>[<span class="keyword">int</span>]<span class="keyword">interface</span>&#123;&#125;</span>)</span> &#123;</span><br><span class="line">	<span class="keyword">for</span> k, v := <span class="keyword">range</span> m &#123;</span><br><span class="line">		fmt.Println(k, <span class="string">":"</span>, v)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">输出：</span><br><span class="line"><span class="number">1</span> : a</span><br><span class="line"><span class="number">2</span> : <span class="number">2</span></span><br><span class="line"><span class="number">3</span> : <span class="literal">false</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p><code>[]string</code> 和 <code>[]interface{}</code> 是不同的类型；
接口是一种抽象类型，可理解为是将所有具体类型按照方法集进行再分类；
指针方法集包含非指针方法集。</p>
</blockquote>
<p>（3）接口值（interface value）包含 类型 （接口的动态类型）和 类型值 （接口的动态值） 两个部分，仅当两者均为<code>nil</code> 时，接口才为<code>nil</code>
<img src="https://upload-images.jianshu.io/upload_images/1863961-48d541dd9a4ab443.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/800" alt="The zero value for an interface has both its type and value components set to nil">
（4）反射 （reflection）</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"reflect"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> iphone <span class="keyword">struct</span> &#123;</span><br><span class="line">	version <span class="keyword">string</span></span><br><span class="line">	price   <span class="keyword">int</span></span><br><span class="line">	user    <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> (<span class="params">iph iphone</span>) <span class="title">Wechat</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"I installed wechat on my iphone"</span>, iph.version)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">	my_phone := iphone&#123;<span class="string">"X"</span>, <span class="number">8316</span>, <span class="string">"Xiaohe"</span>&#125;</span><br><span class="line">	Info(my_phone)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Info</span>(<span class="params">itf <span class="keyword">interface</span>&#123;&#125;</span>)</span> &#123;</span><br><span class="line">	t := reflect.TypeOf(itf)</span><br><span class="line">	fmt.Println(t)</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; t.NumField(); i++ &#123;</span><br><span class="line">		fmt.Println(t.Field(i))</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	fmt.Println(<span class="string">"___________________"</span>)</span><br><span class="line"></span><br><span class="line">	v := reflect.ValueOf(itf)</span><br><span class="line">	fmt.Println(v)</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; v.NumField(); i++ &#123;</span><br><span class="line">		fmt.Println(v.Field(i))</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">输出：</span><br><span class="line">main.iphone</span><br><span class="line">&#123;version main <span class="keyword">string</span>  <span class="number">0</span> [<span class="number">0</span>] <span class="literal">false</span>&#125;</span><br><span class="line">&#123;price main <span class="keyword">int</span>  <span class="number">16</span> [<span class="number">1</span>] <span class="literal">false</span>&#125;</span><br><span class="line">&#123;user main <span class="keyword">string</span>  <span class="number">24</span> [<span class="number">2</span>] <span class="literal">false</span>&#125;</span><br><span class="line">___________________</span><br><span class="line">&#123;X <span class="number">8316</span> Xiaohe&#125;</span><br><span class="line">X</span><br><span class="line"><span class="number">8316</span></span><br><span class="line">Xiaohe</span><br></pre></td></tr></table></figure>
<h3><span id="kong-zhi-liu-for-if-switch-defer-goto">控制流 （for if switch defer goto）：</span><a href="#kong-zhi-liu-for-if-switch-defer-goto" class="header-anchor">#</a></h3>
<p>（1）<code>for</code>：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (inti statement)；condition；(post statement) &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">10</span>; i++ &#123;</span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">for</span> ; i &lt; <span class="number">10</span>; &#123;    <span class="comment">// 去掉分号</span></span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">for</span> i &lt; <span class="number">10</span>&#123;    <span class="comment">// while 语句</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>&#123;    <span class="comment">// 无限循环</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>（2）<code>if</code>：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">if</span> (init statement)；condition &#123;</span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (init statement)；condition &#123;</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>（3）<code>switch</code>：</p>
 <figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch</span> (init statement)；some value &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0</span>：</span><br><span class="line">    <span class="keyword">case</span> f()：</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">default</span>：</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">switch</span> &#123;</span><br><span class="line">    <span class="keyword">case</span> 布尔表达式<span class="number">1</span>：</span><br><span class="line">    <span class="keyword">case</span> 布尔表达式<span class="number">2</span>：</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">default</span>：</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>一旦符合条件自动终止，若希望继续检验下面的case，使用 <code>fallthrough</code> 语句。
（4）<code>defer</code>：</p>
<ul>
<li>defer 后必须跟函数引用</li>
<li>defer 语句被检验后，延迟函数获得变量的拷贝</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">a</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    i := <span class="number">0</span></span><br><span class="line">    <span class="keyword">defer</span> fmt.Println(i)</span><br><span class="line">    i++</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">&#125;    <span class="comment">// defer 语句打印0</span></span><br></pre></td></tr></table></figure>
<ul>
<li>defer 语句被检验后，延迟匿名函数获得变量的地址</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">b</span>(<span class="params"></span>) (<span class="params">i <span class="keyword">int</span></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">defer</span> <span class="function"><span class="keyword">func</span>(<span class="params"></span>)</span> &#123; i++ &#125;()</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>    <span class="comment">// 将1 赋给 i</span></span><br><span class="line">&#125;    <span class="comment">// 返回 2。利用 defer 语句修改外围函数的命名返回值</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">c</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">3</span>; i++ &#123;</span><br><span class="line">	  <span class="keyword">defer</span> <span class="function"><span class="keyword">func</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">	        fmt.Print(i)</span><br><span class="line">	  &#125;()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">&#125;  <span class="comment">// 打印 333</span></span><br></pre></td></tr></table></figure>
<ul>
<li>defer 语句被检验后，延迟函数的引用被推入堆栈，当外围函数返回后，按照后进先出的顺序被调用（即使外围函数发生错误，如 panic，延迟函数仍然会被调用）</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">d</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">4</span>; i++ &#123;</span><br><span class="line">        <span class="keyword">defer</span> fmt.Print(i)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;    <span class="comment">// 打印 3210</span></span><br></pre></td></tr></table></figure>
<p>更多细节如，<code>panic</code>， <code>recover</code>（只能用在延迟函数中） 参考 <a href="https://blog.golang.org/defer-panic-and-recover" target="_blank" rel="noopener">defer blog</a>。</p>
<p>（5）<code>goto</code>：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">LABEL:</span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">10</span>; i++ &#123;</span><br><span class="line">			<span class="keyword">if</span> i &gt; <span class="number">3</span> &#123;</span><br><span class="line">				<span class="keyword">break</span> LABEL    <span class="comment">// 跳出与LABEL同级的循环，即跳出无限循环</span></span><br><span class="line">			&#125; </span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">LABEL:</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">10</span>; i++ &#123;</span><br><span class="line">		<span class="keyword">for</span> &#123;</span><br><span class="line">			<span class="keyword">continue</span> LABEL</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">LABEL:</span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">10</span>; i++ &#123;</span><br><span class="line">			<span class="keyword">if</span> i &gt; <span class="number">3</span> &#123;</span><br><span class="line">				<span class="keyword">goto</span> LABEL    <span class="comment">// 将再次进入无限循环</span></span><br><span class="line">			&#125; </span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>通常<code>标签</code>放到 <code>goto</code> 的后面。</p>
</blockquote>
<h3><span id="chuang-jian-gong-cheng-mu-lu">创建工程目录：</span><a href="#chuang-jian-gong-cheng-mu-lu" class="header-anchor">#</a></h3>
<p>Go工程中共有三个部分：</p>
<ul>
<li>src：存放go源码文件</li>
<li>pkg：存放编译后的包文件</li>
<li>bin：存放编译后的可执行文件</li>
</ul>
<blockquote>
<p>**注意：**src目录需要自己创建，pkg和bin编译时会自动创建。</p>
</blockquote>
<p>步骤：</p>
<ol>
<li>新建工程目录，my_project，并在该目录下创建 src目录；</li>
<li>把my_project 添加到 GOPATH，GOPATH=/home/user/...;my_project（可以同时添加多个路径目录，Linux下用冒号:隔开，window下分号;隔开）;</li>
<li>在 src 下创建my_pkg 和 my_cmd;</li>
<li>包文件放入到 my_pkg 中，比如 test.go</li>
</ol>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> my_pkg</span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Test</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  fmt.Println(<span class="string">"Hello,world!"</span>)</span><br><span class="line">  fmt.Println(<span class="string">"You used a function defined in my_package!"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在命令行src目录，执行 <code>go install my_pkg</code> 将创建 pkg 目录并声成 my_pkg.a 文件。</p>
<ol start="5">
<li>my_cmd 中放入 package main，比如 hello_world.go</li>
</ol>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span>(</span><br><span class="line">  <span class="string">"my_pkg"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  my_pkg.Test()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在命令行src目录，执行 <code>go install my_cmd</code> 将创建 bin 目录并生成可执行文件成 hello_world.exe 文件。</p>
<blockquote>
<p>目录结构：
src/
$\quad$ my_pkg/
$\qquad$ test.go
$\quad$ my_cmd/
$\qquad$ hello_world.go</p>
</blockquote>
<h3><span id="tips">Tips:</span><a href="#tips" class="header-anchor">#</a></h3>
<p>import 包A的时候，会自动调用包A的init()函数（i字母小写）。如果该包A又import了别的包B，会优先调用包B的init()函数，最后才调用main包的init()函数。
一个包的init()函数可以定义多个，每个都会被调用，调用的顺序按文件名排序。同一个文件也可以定义多个init函数。</p>
<h3><span id="qi-ta">其他：</span><a href="#qi-ta" class="header-anchor">#</a></h3>
<ul>
<li><code>fmt.printf</code> verbs：
<code>%x %b</code>：16进制，2进制显示；<code>%t</code>：显示 bool 结果；<code>%T</code>：显示值的类型；<code>%v</code>：显示值；<code>%p</code>：显示地址；<code>\n</code>：换行</li>
<li>Sublime text 3
上一个编辑处: alt+-
下一个编辑处: alt+shift+-</li>
<li>GoSublime：
GoSublime快捷键列表：ctrl+.+. (连击 .)
查看声明：ctrl+.+h
代码跳转：ctrl+shift+左键
package control：ctrl+shift+p</li>
<li>Goland：退回上一次光标位置：ctrl+win+alt+左键</li>
</ul>
<h3><span id="can-kao-zi-liao">参考资料：</span><a href="#can-kao-zi-liao" class="header-anchor">#</a></h3>
<p>[1] 无闻;<a href="https://study.163.com/course/introduction.htm?courseId=306002" target="_blank" rel="noopener">Go编程基础系列视频</a>.
[2] Alan A.A. Donovan; Brain W. Kernighan; The Go Programming Language; 2015.</p>

  </section>

</article>

<section class="read-more">
     

        
            <div class="read-more-item">
                <span class="read-more-item-dim">最近的文章</span>
                <h3 class="post-list__post-title post-title"><a href="/2018/10/18/2018-10-18/" title="A Study for the Reed-Solomon Code">A Study for the Reed-Solomon Code</a></h3>
                <p class="excerpt">
                
                



Introduction
Galois Field
Galois Field Arithmetic

Addition and Subtraction
Multiplication and Division


RS Code

Coding Matrix Method
Generator 
                &hellip;
                </p>
                <div class="post-list__meta"><time datetime="2018-10-18T04:11:11.000Z" class="post-list__meta--date date">2018-10-18</time> &#8226; <span class="post-list__meta--tags tags">
  <a class="tag-link" href="/tags/Golang/">Golang</a>, <a class="tag-link" href="/tags/RS-Code/">RS Code</a>, <a class="tag-link" href="/tags/长文/">长文</a>
</span><a class="btn-border-small" href="/2018/10/18/2018-10-18/">阅读全文</a></div>

            </div>
        

        
            <div class="read-more-item">
                <span class="read-more-item-dim">更早的文章</span>
                <h3 class="post-list__post-title post-title"><a href="/2018/07/04/2018-7-4/" title="本地项目上传到 Github 仓库、Git开发命令">本地项目上传到 Github 仓库、Git开发命令</a></h3>
                <p class="excerpt">
                
                



生成本地版本库 （.git 文件夹）
创建 SSH key
创建 GitHub 仓库
上传到 GitHub 仓库
本地修改跟新到 GitHub 仓库



生成本地版本库 （.git 文件夹）#
123git initgit add .git commit -m &#34;...&#34;
操作如下，



                &hellip;
                </p>
                <div class="post-list__meta"><time datetime="2018-07-04T11:35:11.000Z" class="post-list__meta--date date">2018-07-04</time> &#8226; <span class="post-list__meta--tags tags">
  <a class="tag-link" href="/tags/Git/">Git</a>
</span><a class="btn-border-small" href="/2018/07/04/2018-7-4/">阅读全文</a></div>

            </div>
        

   


</section>


  


            <footer class="footer">
    <span class="footer__copyright">
        2021 &copy; Jiang-Tao He - Powered by <a href="https://hexo.io">Hexo</a> with <a href="https://github.com/monniya/hexo-theme-new-vno ">new-vno</a> theme originated from <a href="https://github.com/onevcat/vno" target="_blank">onevcat</a>. Hosted by Netlify.

    </span>
    <span class="footer__copyright">
            
         </span>


  
         <script type="text/x-mathjax-config">
    MathJax.Hub.Config({"HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"], linebreaks: { automatic:true }, EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50) },
        tex2jax: { inlineMath: [ ["$", "$"], ["\\(","\\)"] ], processEscapes: true, ignoreClass: "tex2jax_ignore|dno",skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']},
        TeX: {  noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } }, Macros: { href: "{}" } },
        messageStyle: "none"
    }); 
    
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>
<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
 
</footer>


<div id="totop" style="position:fixed;bottom:150px;right:20px;cursor: pointer;">
<a title="返回顶部"><img src="/images/scrollup.png"/></a>
</div>
<script src="/js/totop.js"></script>


        </div>
    </div>

     
<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-119463453-1', 'auto');
	ga('send', 'pageview');
</script>

    
    <script>
        var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "//hm.baidu.com/hm.js?cbff5c9c1c024f714d2c51527df12893";
            var s = document.getElementsByTagName("script")[0]; 
            s.parentNode.insertBefore(hm, s);
        })();
    </script>



    <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config("");
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->


<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","model":{"jsonPath":"/live2dw/assets/tororo.model.json"},"display":{"position":"right","width":140,"height":280,"hOffset":-28,"vOffset":-63},"mobile":{"show":true,"motion":true},"log":false,"tagMode":false});</script></body>
</html>
